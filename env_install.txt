# To install SB3 environment install wind-farm-env and stable baselines (3.8/3.9)

# To install Scaffolder environment install wind-farm-env and scaffolder (python 3.9)
conda create -n scaffolder_wf2 python==3.9 
conda activate scaffolder_wf2
cd wind-farm-env/
pip install ./dist/wind_farm_gym-0.0.3-py3-none-any.whl 
pip install scikit-learn
pip install gym
    # At this point Floris gym works
# Move to scaffolder and run pip install -r requirements.txt
cd ../scaffolder
pip install -r requirements.txt 
pip install -e .
pip install tensorflow_probability
pip install gymnasium-robotics
pip install -U "jax[cuda12]"
pip install tensorflow[and-cuda]




ml load <SADL modules>
conda create env -p <path> python==3.9.19
pip install -U "jax[cuda12]"

# Scaffolder install
git clone https://github.com/penn-pal-lab/scaffolder.git
# Remove all set versions from requirements.txt (==2.3.12)
pip install cloudpickle crafter gym jax jaxlib numpy optax rich ruamel.yaml tensorflow
cd scaffolder
pip install -e .
cd ..

# Floris env install
git clone https://github.com/AlgTUDelft/wind-farm-env.git
cd wind-farm-env
pip install scikit-learn
pip install --upgrade build
python -m build
export SKLEARN_ALLOW_DEPRECATED_SKLEARN_PACKAGE_INSTALL=True
pip install dist/wind_farm_gym-0.0.3-py3-none-any.whl 
# Had to do this for some reason, wind_farm_gym was not being recognized...
#pip install dist/wind_farm_gym-0.0.3-py3-none-any.whl --force-reinstall

# Did this, but didnt help (i think)
# install pyvirtualdisplay
# ml load Xvfb
# export PYOPENGL_PLATFORM='egl' 

pip cache purge
conda clean -a
export TMPDIR=/data1/s3442209/tmp
pip install stable-baselines3[extra]

# This must be added to scripts to run headless
import pyglet
pyglet.options["headless"] = True


conda install -c conda-forge libstdcxx-ng


# # #
New dependencies
pip install jax jaxlib
